<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC  "-//mybatis.org//DTD Config 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">



<mapper namespace="com.example.demo.mapper.BoardMapper">
    <select id="selectAllBoard" resultType="BoardSearchAllDTO">
        SELECT *
        FROM TB_BOARD
        ORDER BY ID DESC
    </select>

    <select id="selectIdMaxPlusOne" resultType="String">
        SELECT MAX(id) + 1
        FROM TB_BOARD
    </select>

    <insert id="saveBoard">
      INSERT INTO TB_BOARD
      VALUES(#{id},#{title},#{content},#{writer},now(),#{writer},now(),#{writer})
    </insert>

  <!-- 게시물 조회 쿼리 -->
   <select id="getBoardById"  resultType="BoardSearchAllDTO">
        SELECT * FROM TB_BOARD WHERE id = #{id}
    </select>


    <select id="getSearch" resultType="BoardSearchAllDTO">
        SELECT * 
        FROM TB_BOARD
        WHERE 
        <choose>
          <when test="searchType.equals('title')">
             title like concat ('%',#{keyword},'%')
          </when>
          <when test="searchType.equals('content')">
             content like concat ('%',#{keyword},'%')
          </when>
           <when test="searchType.equals('title_content')">
             content like concat ('%',#{keyword},'%')
          </when>
          <when test="searchType.equals('writer')">
             writer like concat ('%',#{keyword},'%')
          </when>          
        </choose>
        order by id desc;
    </select>

    <delete id="beleteBoard">
      delete from TB_BOARD
      where id = #{id}
    </delete>
</mapper>